import React,{useContext,useState,useEffect} from 'react'
import logoIcon from '../assets/Icon.png'
import logoutImage from '../assets/logout.png'
import { Link, NavLink,useNavigate } from 'react-router-dom'
import {profileActions} from '../store/profile-slice'
import {authActions} from '../store/auth-slice'
import { useDispatch, useSelector } from 'react-redux'
import { API} from "../config/api";
import { logout } from '../store/auth-action'

function Sidebar(props) {
    const [name,setName] = useState(null)
    const [userStatus,setUserStatus] = useState(null)
    const [image,setImage] = useState(null)
    const dispatch = useDispatch()
    const isLoginId = useSelector((state)=>state.auth.isLoginId)
    const baseURL = useSelector((state)=> state.profile.baseURL)
    const user = useSelector((state)=>state.profile.user)
    useEffect(() => {
        if (user.users){
            setName(user.users.fullName)
             setUserStatus(user.users.userStatus)
             console.log(user.users.userStatus)
             setImage(user.image)
        }
        
    }, [user])
       
    const navigate = useNavigate()
    const subscribe = () => {
        if (userStatus == 'Active') {
            return (
                <div style={{color:'#29BD11'}}>Subscribed</div>
            )
        } else {
            return (
                <div className="textColorRed">Not Subscribed Yet</div>
            )
        } 
    }
    const handleLogout = async (e) =>{
        e.preventDefault()
        dispatch(logout(isLoginId))
        navigate('/')
    }
    return (
        <div style={{width:'218px',height:'100vh'}} className="fixed">
            <div>
                <Link to="/home">
                <img className="m-auto" src={logoIcon} width="98px" alt=""/>
                </Link>
                
                <img className="m-auto rounded-full shadow-xl mb-5 mt-5" src={`${baseURL}/${image}`} width="112px"style={{height:'110px',border:'5px solid black'}} alt=""/>
                <p className="text-2xl text-center font-bold mb-3">{name}</p>
                <p className="text-lg textColorRed text-center font-semibold">{subscribe()}</p>
                <hr />
            </div>
            <div className="">
                <NavLink activeClassName="active" className="text-gray-500" to="/profile">
                <div className="flex items-center py-8">
                <svg width="25" height="25" viewBox="0 0 25 25" xmlns="http://www.w3.org/2000/svg">
                <path d="M12.5 0C8.86528 0 5.9082 2.95708 5.9082 6.5918C5.9082 10.2265 8.86528 13.1836 12.5 13.1836C16.1347 13.1836 19.0918 10.2265 19.0918 6.5918C19.0918 2.95708 16.1347 0 12.5 0ZM12.5 11.7188C9.673 11.7188 7.37305 9.4188 7.37305 6.5918C7.37305 3.76479 9.673 1.46484 12.5 1.46484C15.327 1.46484 17.627 3.76479 17.627 6.5918C17.627 9.4188 15.327 11.7188 12.5 11.7188Z" className="svg"/>
                <path d="M14.5426 14.6973H10.4573C7.07832 14.6973 3.7436 16.2574 1.51367 19.6024V25H23.4863V19.6024C21.2596 16.2622 17.9258 14.6973 14.5426 14.6973ZM22.0215 23.5352H22.0215H2.97852V20.0506C4.68901 17.6115 7.46836 16.1621 10.4574 16.1621H14.5427C17.5317 16.1621 20.311 17.6115 22.0215 20.0506V23.5352Z" />
                </svg>

                    <p className="ml-5 text-2xl">Profile</p>
                </div>
                </NavLink>
                
               <NavLink activeClassName="active" className="text-gray-500" to="/subscribe">
               <div className="flex py-8">
               <svg width="30" height="30" viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_12_132)">
                    <path d="M22.9871 4.97369C23.0001 4.97464 23.0132 4.97559 23.0265 4.97559C23.049 4.97559 23.0716 4.97369 23.0936 4.97061C23.6843 4.98271 24.1571 5.46449 24.1578 6.0552C24.1578 6.32361 24.3754 6.54124 24.6439 6.54124C24.9123 6.54124 25.1299 6.32361 25.1299 6.0552C25.1287 5.08904 24.4561 4.25317 23.5125 4.04527V3.57821C23.5125 3.30979 23.2949 3.09216 23.0265 3.09216C22.7581 3.09216 22.5404 3.30979 22.5404 3.57821V4.06734C21.5427 4.3341 20.8972 5.29931 21.0317 6.32337C21.1663 7.34744 22.0392 8.11306 23.072 8.11306C23.6718 8.11306 24.1578 8.59934 24.1578 9.19907C24.1578 9.79856 23.6718 10.2848 23.072 10.2848C22.4723 10.2848 21.9863 9.79856 21.9863 9.19907C21.9863 8.93065 21.7686 8.71302 21.5002 8.71302C21.2318 8.71302 21.0142 8.93065 21.0142 9.19907C21.0154 10.1303 21.641 10.9451 22.5404 11.1869V11.7195C22.5404 11.9879 22.7581 12.2055 23.0265 12.2055C23.2949 12.2055 23.5125 11.9879 23.5125 11.7195V11.2092C24.539 10.9845 25.2312 10.0224 25.118 8.97764C25.0051 7.93293 24.1229 7.1412 23.072 7.14144C22.4889 7.14168 22.0098 6.68126 21.9867 6.09863C21.964 5.51599 22.4056 5.01926 22.9871 4.97393V4.97369Z"/>
                    <path d="M23.0998 0.715698C20.1097 0.715698 17.558 2.66676 16.602 5.27926H4.53842C4.27119 5.27926 4.05427 5.52015 4.05237 5.78714L3.9375 22.8377H0.498863C0.230445 22.8377 0 23.032 0 23.3009V25.4647C0.00617049 27.5016 1.61051 29.175 3.64535 29.2671V29.2778H18.6521V29.2635C18.7736 29.2681 18.8236 29.2778 18.9005 29.2778H18.911C21.017 29.2745 22.7227 27.5662 22.7227 25.4601V14.5203C22.8442 14.527 22.9728 14.5305 23.0986 14.5305C26.9037 14.5305 30.0001 11.4282 30.0001 7.62287C30.0001 3.8178 26.9051 0.715698 23.0998 0.715698ZM3.83023 28.3057H3.82715C2.25485 28.3036 0.979214 27.0322 0.972094 25.4597V23.8098H15.0675V25.4528C15.0682 26.4671 15.4733 27.4395 16.1929 28.1545C16.2439 28.2055 16.3073 28.2449 16.3607 28.3057H3.83023ZM21.7506 25.4597C21.7508 27.0294 20.48 28.3026 18.9105 28.3057H18.9012C17.3254 28.3028 16.0474 27.0289 16.0396 25.4533V23.3009C16.0436 23.1766 15.9961 23.0563 15.9081 22.9684C15.82 22.8806 15.6997 22.8334 15.5756 22.8377H4.9096L5.02114 6.25135H16.3322C16.246 6.69634 16.2014 7.14821 16.199 7.60127C16.1981 8.55936 16.3979 9.50677 16.7857 10.3827H12.1948C11.9262 10.3827 11.7088 10.6004 11.7088 10.8688C11.7088 11.1372 11.9262 11.3548 12.1948 11.3548H17.3131C18.3158 12.9316 19.9187 14.0309 21.7506 14.3988V25.4597ZM23.0998 13.5587C19.8256 13.5587 17.1711 10.9044 17.1714 7.62999C17.1714 4.35559 19.8256 1.70132 23.1 1.70132C26.3742 1.70132 29.0285 4.35582 29.0285 7.62999C29.0249 10.9027 26.3728 13.5551 23.0998 13.5587Z"/>
                    <path d="M9.07497 13.6176C8.21703 13.6176 7.51929 14.2932 7.51929 15.1239C7.51929 15.9545 8.21703 16.6302 9.07497 16.6302C9.93291 16.6302 10.6309 15.9545 10.6309 15.1239C10.6309 14.2932 9.93291 13.6176 9.07497 13.6176ZM9.07497 15.6581C8.75292 15.6581 8.49138 15.4184 8.49138 15.1239C8.49138 14.8291 8.75316 14.5897 9.07497 14.5897C9.39679 14.5897 9.6588 14.8294 9.6588 15.1239C9.6588 15.4184 9.39679 15.6581 9.07497 15.6581Z"/>
                    <path d="M11.7087 15.1218C11.7087 15.3902 11.9261 15.6078 12.1948 15.6078H18.6748C18.9432 15.6078 19.1608 15.3902 19.1608 15.1218C19.1608 14.8534 18.9432 14.6357 18.6748 14.6357H12.1948C11.9261 14.6357 11.7087 14.8534 11.7087 15.1218Z"/>
                    <path d="M9.07497 9.39246C8.21703 9.39246 7.51929 10.0684 7.51929 10.899C7.51929 11.7297 8.21703 12.4053 9.07497 12.4053C9.93291 12.4053 10.6309 11.7297 10.6309 10.899C10.6309 10.0684 9.93291 9.39246 9.07497 9.39246ZM9.07497 11.4332C8.75292 11.4332 8.49138 11.1935 8.49138 10.899C8.49138 10.6045 8.75316 10.3646 9.07497 10.3646C9.39679 10.3646 9.6588 10.6043 9.6588 10.899C9.6588 11.1935 9.39679 11.4335 9.07497 11.4335V11.4332Z"/>
                    <path d="M9.07497 17.8423C8.21703 17.8423 7.51929 18.518 7.51929 19.3486C7.51929 20.1792 8.21703 20.8549 9.07497 20.8549C9.93291 20.8549 10.6309 20.1792 10.6309 19.3486C10.6309 18.518 9.93291 17.8423 9.07497 17.8423ZM9.07497 19.8828C8.75292 19.8828 8.49138 19.6433 8.49138 19.3486C8.49138 19.0541 8.75316 18.8144 9.07497 18.8144C9.39679 18.8144 9.6588 19.0541 9.6588 19.3486C9.6588 19.6431 9.39679 19.8828 9.07497 19.8828Z"/>
                    <path d="M18.6748 18.8887H12.1948C11.9261 18.8887 11.7087 19.1063 11.7087 19.3747C11.7087 19.6431 11.9261 19.8608 12.1948 19.8608H18.6748C18.9432 19.8608 19.1608 19.6431 19.1608 19.3747C19.1608 19.1063 18.9432 18.8887 18.6748 18.8887Z"/>
                    </g>
                    <defs>
                    <clipPath id="clip0_12_132">
                <rect width="30" height="30" fill="white"/>
</clipPath>
</defs>
</svg>

                    <p className="ml-5 text-2xl">Subscribe</p>
                </div>
               </NavLink>
               
                
                <hr className=""/>
            </div>

            <NavLink onClick={handleLogout} className="text-gray-500" to="/">
            <div className="flex pt-5">
            <img src={logoutImage} width='25px' alt=""/>
            <p className="text-2xl ml-5">Logout</p>
            </div>
            </NavLink>
            
           
            
        </div>
    )
}

export default Sidebar
